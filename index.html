<!DOCTYPE html>
<html lang="hy">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wildberries ‘Ω’°’∂’∏÷Ç’©</title>
    <!-- ‘≤’•’º’∂’∏÷Ç’¥ ’•’∂÷Ñ Tailwind CSS-’® -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7f7f7; /* ‘π’•’©÷á ’¥’∏’≠÷Ä’°’£’∏÷Ç’µ’∂ ÷Ü’∏’∂ */
        }
        /* ‘ø’∏’≥’°’Ø’´ ’∞’´’¥’∂’°’Ø’°’∂ ’§’´’¶’°’µ’∂’® */
        .tab-button {
            transition: all 0.2s;
            border-radius: 0.5rem;
        }
        .tab-button.active {
            background-color: #5d3d82; /* Wildberries-’´ ’∂’¥’°’∂ ’£’∏÷Ç’µ’∂ */
            color: white;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1);
        }
        .product-card {
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            cursor: pointer;
        }
        .product-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -4px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body class="text-gray-800">

    <div id="app" class="max-w-4xl mx-auto p-4 sm:p-6">
        <!-- ‘≥’¨’≠’°’æ’∏÷Ä ’é’•÷Ä’∂’°’£’´÷Ä ÷á ’Ü’°’æ’´’£’°÷Å’´’° -->
        <header class="mb-6">
            <h1 class="text-3xl font-extrabold text-[#5d3d82] mb-4 text-center">üõç Wildberries ‘Ω’°’∂’∏÷Ç’©</h1>
            <div id="user-info" class="text-center text-sm mb-4">
                <p id="auth-status" class="text-gray-500">’Ñ’´’°’∂’∏÷Ç’¥ ’ß...</p>
                <p id="user-id-display" class="text-xs text-gray-400 mt-1"></p>
            </div>
            
            <div id="tabs" class="flex justify-center p-1 bg-white rounded-xl shadow-lg">
                <button data-tab="products" class="tab-button active w-1/2 py-2.5 font-semibold text-sm">
                    ‘±’∫÷Ä’°’∂÷Ñ’∂’•÷Ä
                </button>
                <button data-tab="request" class="tab-button w-1/2 py-2.5 font-semibold text-sm">
                    ’ä’°’ø’æ’•÷Ä
                </button>
            </div>
        </header>

        <!-- ‘≤’°’™’´’∂’∂’•÷Ä -->
        <div id="products-section" class="tab-content">
            <h2 class="text-2xl font-bold mb-4 text-gray-700">‘≤’∏’¨’∏÷Ä ‘±’∫÷Ä’°’∂÷Ñ’∂’•÷Ä’®</h2>
            <div id="product-list" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- ‘±’∫÷Ä’°’∂÷Ñ’∂’•÷Ä’® ’Ø’¢’•’º’∂’æ’•’∂ ’°’µ’Ω’ø’•’≤ -->
                <div class="text-center py-10 text-gray-500">‘≤’•’º’∂’æ’∏÷Ç’¥ ’•’∂ ’°’∫÷Ä’°’∂÷Ñ’∂’•÷Ä’®...</div>
            </div>
        </div>

        <div id="request-section" class="tab-content hidden">
            <h2 class="text-2xl font-bold mb-4 text-gray-700">’ä’°’ø’æ’•÷Ä (‘±’∫÷Ä’°’∂÷Ñ, ’∏÷Ä’® ’π’Ø’°)</h2>
            <div id="request-form-container" class="bg-white p-6 rounded-xl shadow-lg">
                <p class="text-gray-600 mb-4">
                    ‘µ’©’• ’°’∫÷Ä’°’∂÷Ñ’® ’π’Ø’° ’¥’•÷Ä ’Ø’°’ø’°’¨’∏’£’∏÷Ç’¥, ’∏÷Ç’≤’°÷Ä’Ø’•÷Ñ ’∞’°÷Ä÷Å’∏÷Ç’¥÷â ’Ñ’•’∂÷Ñ ’Ø÷É’∏÷Ä’±’•’∂÷Ñ ’£’ø’∂’•’¨ ’°’µ’∂ ’Å’•’¶ ’∞’°’¥’°÷Ä÷â
                </p>

                <form id="product-request-form" onsubmit="handleRequestSubmit(event)">
                    <div class="mb-4">
                        <label for="request-name" class="block text-sm font-medium text-gray-700 mb-1">‘±’∫÷Ä’°’∂÷Ñ’´ ‘±’∂’∏÷Ç’∂</label>
                        <input type="text" id="request-name" name="name" required
                               class="w-full p-3 border border-gray-300 rounded-lg focus:ring-purple-500 focus:border-purple-500 transition duration-150">
                    </div>

                    <div class="mb-4">
                        <label for="request-description" class="block text-sm font-medium text-gray-700 mb-1">’Ñ’°’∂÷Ä’°’¥’°’Ω’∂ ’Ü’Ø’°÷Ä’°’£÷Ä’∏÷Ç’©’µ’∏÷Ç’∂</label>
                        <textarea id="request-description" name="description" rows="4" required
                                  class="w-full p-3 border border-gray-300 rounded-lg focus:ring-purple-500 focus:border-purple-500 transition duration-150"
                                  placeholder="’Ü’Ø’°÷Ä’°’£÷Ä’•÷Ñ ’°’∫÷Ä’°’∂÷Ñ’®, ’∂’∑’•÷Ñ ’£’∏÷Ç’µ’∂’®, ’π’°÷É’® ÷á ’°’µ’¨ ’¥’°’∂÷Ä’°’¥’°’Ω’∂’•÷Ä÷â"></textarea>
                    </div>

                    <div class="mb-6">
                        <label class="block text-sm font-medium text-gray-700 mb-1">’Ü’Ø’°÷Ä (’è’•’≤’•’Ø’°’ø’æ’°’Ø’°’∂)</label>
                        <div class="p-3 border-2 border-dashed border-gray-300 rounded-lg text-center bg-gray-50">
                            <p class="text-sm text-gray-500">
                                ’è’æ’µ’°’¨ ’¥’´’ª’°’æ’°’µ÷Ä’∏÷Ç’¥ ’∂’Ø’°÷Ä’∂’•÷Ä ’∏÷Ç’≤’°÷Ä’Ø’•’¨’∂ ’°’∂’∞’∂’°÷Ä ’ß÷â ‘Ω’∂’§÷Ä’∏÷Ç’¥ ’•’∂÷Ñ ’¥’°’∂÷Ä’°’¥’°’Ω’∂ ’∂’Ø’°÷Ä’°’£÷Ä’•’¨ ’°’∫÷Ä’°’∂÷Ñ’® ’æ’•÷Ä÷á’´ ’§’°’∑’ø’∏÷Ç’¥÷â
                            </p>
                        </div>
                    </div>

                    <button type="submit" id="submit-request-btn"
                            class="w-full py-3 bg-[#5d3d82] text-white font-semibold rounded-lg shadow-md hover:bg-[#4b3168] transition duration-150 disabled:bg-gray-400">
                        ’à÷Ç’≤’°÷Ä’Ø’•’¨ ’Ä’°÷Ä÷Å’∏÷Ç’¥’®
                    </button>
                    <p id="request-message" class="text-center mt-3 text-sm font-medium hidden"></p>
                </form>
            </div>
            
            <div id="user-requests-list" class="mt-8">
                <h3 class="text-xl font-semibold mb-3 text-gray-700">’Å’•÷Ä ’à÷Ç’≤’°÷Ä’Ø’°’Æ ’Ä’°÷Ä÷Å’∏÷Ç’¥’∂’•÷Ä’®</h3>
                <div id="requests-container" class="space-y-3">
                    <p class="text-gray-500 text-sm">’Å’•÷Ä ’∞’°÷Ä÷Å’∏÷Ç’¥’∂’•÷Ä’® ’Ø÷Å’∏÷Ç÷Å’°’§÷Ä’æ’•’∂ ’°’µ’Ω’ø’•’≤÷â</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Firebase ÷á ‘º’∏’£’´’Ø’° -->
    <script type="module">
        // Firebase Imports
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { 
            getFirestore, 
            doc, 
            setDoc, 
            onSnapshot, 
            collection, 
            query, 
            addDoc, 
            serverTimestamp,
            getDocs,
            where,
            orderBy 
        } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        
        import { setLogLevel } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        setLogLevel('Debug'); // ‘±’Ø’ø’´’æ’°÷Å’∂’∏÷Ç’¥ ’•’∂÷Ñ ’¨’∏’£’´’∂’£’® ’§’•’¢’°’£’´ ’∞’°’¥’°÷Ä

        // ‘≥’¨’∏’¢’°’¨ ’ì’∏÷É’∏’≠’°’Ø’°’∂’∂’•÷Ä
        let db;
        let auth;
        let userId = null;
        let appId = null;

        const mockProducts = [
            { name: "‘±’¥’°’º’°’µ’´’∂ ‘∂’£’•’Ω’ø", price: 12500, description: "‘µ’≤’•’£’∂’°’£’∏÷Ç’µ’∂, ’©’•’©÷á ’°’¥’°’º’°’µ’´’∂ ’¶’£’•’Ω’ø", image_url: "https://placehold.co/300x200/4c3f7b/ffffff?text=üëó+‘∂’£’•’Ω’ø" },
            { name: "’ç’∫’∏÷Ä’ø’°’µ’´’∂ ‘ø’∏’∑’´’Ø’∂’•÷Ä", price: 24990, description: "’ç÷á, ’∫÷Ä’∏÷Ü’•’Ω’´’∏’∂’°’¨ ’æ’°’¶÷Ñ’´ ’Ø’∏’∑’´’Ø’∂’•÷Ä", image_url: "https://placehold.co/300x200/3498db/ffffff?text=üëü+‘ø’∏’∑’´’Ø" },
            { name: "‘∫’°’¥’°÷Å’∏÷Ç’µ÷Å", price: 8900, description: "’Ü’∏÷Ä’°’±÷á, ’¥’•’ø’°’≤’°’Ø’°’∂ ’©÷á’∂’∏÷Å’∏’æ ’™’°’¥’°÷Å’∏÷Ç’µ÷Å", image_url: "https://placehold.co/300x200/e67e22/ffffff?text=‚åö+‘∫’°’¥’°÷Å’∏÷Ç’µ÷Å" },
            { name: "‘¥’´’¥’°’∞’°÷Ä’§’°÷Ä’¥’°’∂ ’Ä’°’æ’°÷Ñ’°’Æ’∏÷Ç", price: 15000, description: "‘±’¥’¢’∏’≤’ª’°’Ø’°’∂ ’∞’°’æ’°÷Ñ’°’Æ’∏÷Ç ’§’´’¥’°’∞’°÷Ä’§’°÷Ä’¥’°’∂ ’∞’°’¥’°÷Ä", image_url: "https://placehold.co/300x200/e74c3c/ffffff?text=üíÑ+Make-up" }
        ];

        // ----------------- 1. FIREBASE ’ç‘µ‘π‘±’ì -----------------

        function initializeFirebase() {
            try {
                // 1. ’ç’ø’°’∂’∏÷Ç’¥ ’•’∂÷Ñ ‘≥’¨’∏’¢’°’¨ ’ì’∏÷É’∏’≠’°’Ø’°’∂’∂’•÷Ä’®
                appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
                const firebaseConfig = JSON.parse(typeof __firebase_config !== 'undefined' ? __firebase_config : '{}');
                const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;
                
                if (Object.keys(firebaseConfig).length === 0) {
                    console.error("Firebase config is missing or empty.");
                    document.getElementById('auth-status').textContent = "‚ùå Firebase ’Ø’∏’∂÷Ü’´’£’∏÷Ç÷Ä’°÷Å’´’°’∂ ’¢’°÷Å’°’Ø’°’µ’∏÷Ç’¥ ’ß÷â";
                    return;
                }

                // 2. ‘ª’∂’´÷Å’´’°’¨’´’¶’°÷Å’´’°
                const app = initializeApp(firebaseConfig);
                db = getFirestore(app);
                auth = getAuth(app);

                // 3. ‘±’æ’ø’∏÷Ä’´’¶’°÷Å’´’°
                onAuthStateChanged(auth, async (user) => {
                    if (user) {
                        userId = user.uid;
                        document.getElementById('auth-status').textContent = `‚úÖ ’Ñ’´’°÷Å’°’Æ ’ß`;
                        document.getElementById('user-id-display').textContent = `ID: ${userId}`;
                        console.log("User authenticated:", userId);
                        
                        // ’ç’Ø’Ω’∏÷Ç’¥ ’•’∂÷Ñ ’ø’æ’µ’°’¨’∂’•÷Ä’´ ’¢’•’º’∂’∏÷Ç’¥’®
                        startDataListeners();
                        await seedMockProducts();

                    } else {
                        // ‘µ’©’• ÷Ö’£’ø’°’ø’•÷Ä’® ’£÷Ä’°’∂÷Å’æ’°’Æ ’π’ß, ÷É’∏÷Ä’±’∏÷Ç’¥ ’•’∂÷Ñ ’¥’∏÷Ç’ø÷Ñ ’£’∏÷Ä’Æ’•’¨
                        try {
                            if (initialAuthToken) {
                                console.log("Signing in with custom token...");
                                await signInWithCustomToken(auth, initialAuthToken);
                            } else {
                                console.log("Signing in anonymously...");
                                await signInAnonymously(auth);
                            }
                        } catch (error) {
                            console.error("Authentication failed:", error);
                            document.getElementById('auth-status').textContent = "‚ùå ‘±’æ’ø’∏÷Ä’´’¶’°÷Å’´’°’µ’´ ’Ω’≠’°’¨÷â";
                            userId = crypto.randomUUID(); // ‘±’∂’°’∂’∏÷Ç’∂ ID, ’•’©’• Firebase-’® ’±’°’≠’∏’≤’æ’´
                            document.getElementById('user-id-display').textContent = `‘±’∂’°’∂’∏÷Ç’∂ ID: ${userId}`;
                            startDataListeners(); // ’ì’∏÷Ä’±’∏÷Ç’¥ ’•’∂÷Ñ ’£’∏’∂’• ’ø’æ’µ’°’¨’∂’•÷Ä’® ’¢’•’º’∂’•’¨
                        }
                    }
                });

            } catch (error) {
                console.error("Error during Firebase initialization:", error);
                document.getElementById('auth-status').textContent = "‚ùå ‘æ÷Ä’°’£÷Ä’´ ’´’∂’´÷Å’´’°’¨’´’¶’°÷Å’´’°’µ’´ ’Ω’≠’°’¨÷â";
            }
        }

        // ----------------- 2. ’è’é’Ö‘±‘º’Ü‘µ’ê‘ª ’Ñ’à‘¥‘µ‘º‘ª ’ñ’à’í’Ü‘ø’ë‘ª‘±’Ü‘µ’ê -----------------

        /** ’ç’ø’°’∂’∏÷Ç’¥ ’ß ’∞’≤’∏÷Ç’¥’® ’§’•’∫’´ ’Ä‘±’ê’ë’à’í’Ñ’Ü‘µ’ê‘ª (’Ñ‘±’ç’Ü‘±’é’à’ê) ’∞’°’æ’°÷Ñ’°’Æ’∏÷Ç’∂ */
        function getRequestsCollectionRef() {
            if (!db || !userId || !appId) return null;
            return collection(db, `artifacts/${appId}/users/${userId}/requests`);
        }

        /** ’ç’ø’°’∂’∏÷Ç’¥ ’ß ’∞’≤’∏÷Ç’¥’® ’§’•’∫’´ ‘±’ä’ê‘±’Ü’î’Ü‘µ’ê‘ª (’Ä‘±’Ü’ê‘±’Ö‘ª’Ü) ’∞’°’æ’°÷Ñ’°’Æ’∏÷Ç’∂ */
        function getProductsCollectionRef() {
            if (!db || !appId) return null;
            return collection(db, `artifacts/${appId}/public/data/products`);
        }
        
        // ’Ñ’∏÷Ñ ’°’∫÷Ä’°’∂÷Ñ’∂’•÷Ä’´ ’Ω’Ø’¶’¢’∂’°’Ø’°’∂ ’°’æ’•’¨’°÷Å’∏÷Ç’¥ (’¥’´’°’µ’∂ ’¥’•’Ø ’°’∂’£’°’¥)
        async function seedMockProducts() {
            const productsRef = getProductsCollectionRef();
            if (!productsRef) return;

            const snapshot = await getDocs(productsRef);
            if (!snapshot.empty) {
                console.log("Mock products already seeded.");
                return;
            }

            console.log("Seeding mock products...");
            for (const product of mockProducts) {
                // ’ï’£’ø’°’£’∏÷Ä’Æ’∏÷Ç’¥ ’•’∂÷Ñ ’°’∂’∏÷Ç’∂’® ’∏÷Ä’∫’•’Ω ID
                const docRef = doc(productsRef, product.name.replace(/\s/g, '_'));
                await setDoc(docRef, product);
            }
        }


        // ----------------- 3. ’å‘µ‘±‘º-‘π‘±’Ö’Ñ ‘º‘ª’ç‘π‘µ’Ü‘µ’ê’Ü‘µ’ê (onSnapshot) -----------------

        function startDataListeners() {
            if (!db || !userId) return;

            // ‘º’´’Ω’©’•’∂’•÷Ä ‘±’ä’ê‘±’Ü’î’Ü‘µ’ê‘ª ’∞’°’¥’°÷Ä
            const productsRef = getProductsCollectionRef();
            if (productsRef) {
                onSnapshot(productsRef, (snapshot) => {
                    const products = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                    renderProducts(products);
                }, (error) => {
                    console.error("Error fetching products:", error);
                    document.getElementById('product-list').innerHTML = `<p class="text-center text-red-500 col-span-full">‚ùå ‘±’∫÷Ä’°’∂÷Ñ’∂’•÷Ä’´ ’¢’•’º’∂’¥’°’∂ ’Ω’≠’°’¨÷â</p>`;
                });
            }

            // ‘º’´’Ω’©’•’∂’•÷Ä ’ï‘≥’è‘±’è‘µ’ê‘µ’ê‘ª ’Ä‘±’ê’ë’à’í’Ñ’Ü‘µ’ê‘ª ’∞’°’¥’°÷Ä
            const requestsRef = getRequestsCollectionRef();
            if (requestsRef) {
                // ’î’æ’•÷Ä’´’∂’ù ’∞’°÷Ä÷Å’∏÷Ç’¥’∂’•÷Ä’® ’Ω’ø’•’≤’Æ’¥’°’∂ ’°’¥’Ω’°’©’æ’∏’æ ÷Å’∏÷Ç÷Å’°’§÷Ä’•’¨’∏÷Ç ’∞’°’¥’°÷Ä (’°’º’°’∂÷Å orderBy())
                onSnapshot(requestsRef, (snapshot) => {
                    const requests = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                    renderUserRequests(requests);
                }, (error) => {
                    console.error("Error fetching user requests:", error);
                    document.getElementById('requests-container').innerHTML = `<p class="text-red-500 text-sm">‚ùå ’Ä’°÷Ä÷Å’∏÷Ç’¥’∂’•÷Ä’´ ’¢’•’º’∂’¥’°’∂ ’Ω’≠’°’¨÷â</p>`;
                });
            }
        }

        // ----------------- 4. ’å‘µ’Ü‘¥‘µ’ê‘ª’Ü‘≥‘ª ’ñ’à’í’Ü‘ø’ë‘ª‘±’Ü‘µ’ê -----------------

        /** ’ë’∏÷Ç÷Å’°’§÷Ä’∏÷Ç’¥ ’ß ’¢’∏’¨’∏÷Ä ’°’∫÷Ä’°’∂÷Ñ’∂’•÷Ä’® UI-’∏÷Ç’¥ */
        function renderProducts(products) {
            const container = document.getElementById('product-list');
            if (products.length === 0) {
                container.innerHTML = `<p class="text-center text-gray-500 col-span-full">‘±’∫÷Ä’°’∂÷Ñ’∂’•÷Ä ’§’•’º ’π’Ø’°’∂÷â</p>`;
                return;
            }

            container.innerHTML = products.map(product => `
                <div class="product-card bg-white p-4 rounded-xl shadow-md border border-gray-100">
                    <img src="${product.image_url}" alt="${product.name}" onerror="this.onerror=null;this.src='https://placehold.co/300x200/cccccc/333333?text=’Ü’Ø’°÷Ä’®+‘≤’°÷Å’°’Ø’°’µ’∏÷Ç’¥+’ß';" class="w-full h-32 object-cover rounded-lg mb-3">
                    <h3 class="font-bold text-lg mb-1">${product.name}</h3>
                    <p class="text-sm text-gray-600 mb-2">${product.description}</p>
                    <p class="text-xl font-extrabold text-[#5d3d82]">${product.price.toLocaleString('hy-AM')} ÷è</p>
                    <button onclick="alert('‘±’∫÷Ä’°’∂÷Ñ’® ’¶’°’¥’¢’µ’∏÷Ç’≤’∏÷Ç’¥ ’ß÷â')" class="mt-3 w-full py-2 bg-green-500 text-white font-semibold rounded-lg hover:bg-green-600 transition duration-150 text-sm">
                        ‘±’æ’•’¨’°÷Å’∂’•’¨ ‘∂’°’¥’¢’µ’∏÷Ç’≤
                    </button>
                </div>
            `).join('');
        }

        /** ’ë’∏÷Ç÷Å’°’§÷Ä’∏÷Ç’¥ ’ß ÷Ö’£’ø’°’ø’´÷Ä’∏’ª ’∏÷Ç’≤’°÷Ä’Ø’°’Æ ’∞’°÷Ä÷Å’∏÷Ç’¥’∂’•÷Ä’® */
        function renderUserRequests(requests) {
            const container = document.getElementById('requests-container');
            if (requests.length === 0) {
                container.innerHTML = `<p class="text-gray-500 text-sm">‘¥’∏÷Ç÷Ñ ’§’•’º ’∞’°÷Ä÷Å’∏÷Ç’¥’∂’•÷Ä ’π’•÷Ñ ’∏÷Ç’≤’°÷Ä’Ø’•’¨÷â</p>`;
                return;
            }

            container.innerHTML = requests.map(request => {
                const date = request.timestamp ? new Date(request.timestamp.toDate()).toLocaleDateString('hy-AM') : '‘±’∂’∞’°’µ’ø ’°’¥’Ω’°’©’´’æ';
                return `
                    <div class="bg-gray-100 p-4 rounded-lg border border-gray-200">
                        <p class="font-semibold text-base">${request.name} (’Ä’°÷Ä÷Å’∏÷Ç’¥)</p>
                        <p class="text-sm text-gray-700 mt-1">${request.description}</p>
                        <p class="text-xs text-gray-400 mt-2">’à÷Ç’≤’°÷Ä’Ø’æ’•’¨ ’ß: ${date}</p>
                    </div>
                `;
            }).join('');
        }


        // ----------------- 5. ‘ª’Ü’è‘µ’ê‘±‘ø’è‘ª’é ’ñ’à’í’Ü‘ø’ë‘ª‘±’Ü‘µ’ê -----------------

        /** ‘ø’°’º’°’æ’°÷Ä’∏÷Ç’¥ ’ß ’¢’°’™’´’∂’∂’•÷Ä’´ ÷É’∏÷É’∏’≠’∏÷Ç’©’µ’∏÷Ç’∂’® (Tabs) */
        function setupTabSwitching() {
            const tabs = document.querySelectorAll('.tab-button');
            const sections = {
                products: document.getElementById('products-section'),
                request: document.getElementById('request-section')
            };

            tabs.forEach(button => {
                button.addEventListener('click', () => {
                    const targetTab = button.getAttribute('data-tab');

                    // ‘π’°÷Ä’¥’°÷Å’∂’∏÷Ç’¥ ’•’∂÷Ñ ’Ø’∏’≥’°’Ø’∂’•÷Ä’´ ’°’Ø’ø’´’æ ’æ’´’≥’°’Ø’®
                    tabs.forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');

                    // ’ë’∏÷Ç÷Å’°’§÷Ä’∏÷Ç’¥ ’•’∂÷Ñ ’≥’´’∑’ø ’¢’°’™’´’∂’®
                    Object.values(sections).forEach(section => section.classList.add('hidden'));
                    sections[targetTab].classList.remove('hidden');
                });
            });
        }
        
        // ‘≥’¨’∏’¢’°’¨ ÷Ü’∏÷Ç’∂’Ø÷Å’´’°’ù ’∞’°÷Ä÷Å’¥’°’∂ ’∏÷Ç’≤’°÷Ä’Ø’¥’°’∂ ’∞’°’¥’°÷Ä
        window.handleRequestSubmit = async function(event) {
            event.preventDefault();
            const form = document.getElementById('product-request-form');
            const btn = document.getElementById('submit-request-btn');
            const messageEl = document.getElementById('request-message');
            
            messageEl.classList.add('hidden');
            btn.disabled = true;
            btn.textContent = '‚è≥ ’à÷Ç’≤’°÷Ä’Ø’æ’∏÷Ç’¥ ’ß...';

            if (!userId) {
                messageEl.textContent = '‚ùå ‘Ω’∂’§÷Ä’∏÷Ç’¥ ’•’∂÷Ñ ’Ω’∫’°’Ω’•’¨, ’¥’´’∂’π÷á ’∞’°’¥’°’Ø’°÷Ä’£’® ’Ø’¥’´’°’∂’°÷â';
                messageEl.classList.remove('hidden', 'text-green-500', 'text-red-500');
                messageEl.classList.add('text-red-500');
                btn.disabled = false;
                btn.textContent = '’à÷Ç’≤’°÷Ä’Ø’•’¨ ’Ä’°÷Ä÷Å’∏÷Ç’¥’®';
                return;
            }

            const name = document.getElementById('request-name').value.trim();
            const description = document.getElementById('request-description').value.trim();
            
            try {
                const requestsRef = getRequestsCollectionRef();
                if (!requestsRef) throw new Error("Requests collection reference is invalid.");

                await addDoc(requestsRef, {
                    name: name,
                    description: description,
                    status: '’ç’∫’°’Ω’∏÷Ç’¥ ’ß',
                    userId: userId,
                    timestamp: serverTimestamp()
                });

                messageEl.textContent = '‚úÖ ’Å’•÷Ä ’∞’°÷Ä÷Å’∏÷Ç’¥’® ’∞’°’ª’∏’≤’∏÷Ç’©’µ’°’¥’¢ ’∏÷Ç’≤’°÷Ä’Ø’æ’•’¨ ’ß÷â';
                messageEl.classList.remove('hidden', 'text-red-500');
                messageEl.classList.add('text-green-500');
                form.reset(); // ’Ñ’°÷Ñ÷Ä’∏÷Ç’¥ ’•’∂÷Ñ ÷Ü’∏÷Ä’¥’°’∂

            } catch (error) {
                console.error("Failed to submit request:", error);
                messageEl.textContent = `‚ùå ’ç’≠’°’¨ ’ø’•’≤’´ ’∏÷Ç’∂’•÷Å’°’æ: ${error.message}`;
                messageEl.classList.remove('hidden', 'text-green-500');
                messageEl.classList.add('text-red-500');
            } finally {
                btn.disabled = false;
                btn.textContent = '’à÷Ç’≤’°÷Ä’Ø’•’¨ ’Ä’°÷Ä÷Å’∏÷Ç’¥’®';
            }
        }


        // ----------------- 6. ‘æ’ê‘±‘≥’ê‘ª ’Ñ‘ª’ã’à’ë‘±’å’à’í’Ñ‘∏ -----------------
        
        window.onload = function() {
            setupTabSwitching();
            initializeFirebase();
        };

    </script>
</body>
</html>
