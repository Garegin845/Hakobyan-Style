<!DOCTYPE html>
<html lang="hy">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wildberries ‘Ω’°’∂’∏÷Ç’©</title>
    <!-- Tailwind CSS-’´ ’∂’•÷Ä’¢’•’º’∂’∏÷Ç’¥ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Inter ’ø’°’º’°’ø’•’Ω’°’Ø -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--tg-theme-bg-color, #f4f4f4); /* Telegram ÷Ü’∏’∂’´ ’£’∏÷Ç’µ’∂ */
            color: var(--tg-theme-text-color, #333);
            transition: background-color 0.3s, color 0.3s;
        }
        .header, .footer {
            background-color: var(--tg-theme-secondary-bg-color, #ffffff); /* ‘µ÷Ä’Ø÷Ä’∏÷Ä’§’°’Ø’°’∂ ÷Ü’∏’∂’´ ’£’∏÷Ç’µ’∂ */
        }
        .main-button {
            background-color: var(--tg-theme-button-color, #007bff);
            color: var(--tg-theme-button-text-color, #ffffff);
            transition: background-color 0.2s;
        }
        .main-button:active {
            filter: brightness(0.9);
        }
        .product-card {
            border-color: var(--tg-theme-secondary-bg-color, #e5e7eb);
        }
        .skeleton {
            animation: pulse 1.5s infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
    </style>
</head>
<body>
    
    <div id="app" class="min-h-screen flex flex-col">
        <!-- ‘≥’¨’≠’°’¥’°’Ω (Header) -->
        <div class="header shadow-md p-4 sticky top-0 z-10 flex justify-between items-center rounded-b-xl">
            <h1 class="text-xl font-bold">Wildberries ‘Ω’°’∂’∏÷Ç’© üõçÔ∏è</h1>
            <div id="user-info" class="text-sm"></div>
        </div>

        <!-- ‘±’∫÷Ä’°’∂÷Ñ’∂’•÷Ä’´ ’ë’∏÷Ç÷Å’°’Ø (Products List) -->
        <main class="flex-grow p-4 grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4" id="products-container">
            <!-- ‘±’µ’Ω’ø’•’≤ ’Ø’°’æ’•’¨’°’∂’°’∂ ’°’∫÷Ä’°’∂÷Ñ’∂’•÷Ä’® JS-’´ ’¥’´’ª’∏÷Å’∏’æ -->
            
            <!-- ‘≤’•’º’∂’¥’°’∂ ’ç’Ø’•’¨’•’ø’∏’∂ -->
            <div id="loading-skeleton" class="col-span-2 md:col-span-3 lg:col-span-4 grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
                <div class="product-card bg-gray-200 shadow-lg p-3 rounded-xl skeleton h-64"></div>
                <div class="product-card bg-gray-200 shadow-lg p-3 rounded-xl skeleton h-64"></div>
                <div class="product-card bg-gray-200 shadow-lg p-3 rounded-xl skeleton h-64"></div>
                <div class="product-card bg-gray-200 shadow-lg p-3 rounded-xl skeleton h-64 hidden md:block"></div>
            </div>

        </main>
        
        <!-- ’à’ø÷Ñ (Footer) -->
        <div class="footer shadow-t-lg p-4 sticky bottom-0 z-10 rounded-t-xl">
            <div class="flex justify-between items-center">
                <div id="cart-summary" class="text-lg font-semibold">‘∂’°’¥’¢’µ’∏÷Ç’≤’® ’§’°’ø’°÷Ä’Ø ’ß</div>
                <button id="checkout-button" class="main-button px-6 py-3 rounded-full font-bold shadow-lg opacity-50 cursor-not-allowed" disabled>
                    ’é’≥’°÷Ä’•’¨
                </button>
            </div>
        </div>

        <!-- ’è’•’≤’•’Ø’°’ø’æ’°’Ø’°’∂ ’Ñ’•’Ω’´’ª’´ ’Ñ’∏’§’°’¨ -->
        <div id="message-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
            <div class="bg-white p-6 rounded-xl shadow-2xl max-w-sm w-full text-center">
                <p id="modal-text" class="text-gray-800 font-semibold"></p>
                <button onclick="document.getElementById('message-modal').classList.add('hidden')" class="main-button mt-4 px-4 py-2 rounded-full text-sm">’ì’°’Ø’•’¨</button>
            </div>
        </div>
    </div>

    <!-- Firebase SDK-’´ ’Ü’•÷Ä’¢’•’º’∂’∏÷Ç’¥ -->
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>
    
    <!-- Telegram WebApp SDK-’´ ’Ü’•÷Ä’¢’•’º’∂’∏÷Ç’¥ -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>

    <script>
        // ’Å’•÷Ä ’ø÷Ä’°’¥’°’§÷Ä’°’Æ Firebase-’´ ‘ø’∏’∂÷Ü’´’£’∏÷Ç÷Ä’°÷Å’´’°’∂
        const firebaseConfig = {
            apiKey: "AIzaSyCXp9sfT5rTtKQX95wQi13ZGhfEbqNeMxQ",
            authDomain: "wildberries-shop.firebaseapp.com",
            projectId: "wildberries-shop",
            storageBucket: "wildberries-shop.firebasestorage.app",
            messagingSenderId: "461291386921",
            appId: "1:461291386921:web:970ed17cf9a25893354438",
            measurementId: "G-EYGVT824J5"
        };

        // ‘≥’¨’∏’¢’°’¨ ’ì’∏÷É’∏’≠’°’Ø’°’∂’∂’•÷Ä
        let db;
        let auth;
        let userId = 'anon_user_' + Date.now(); // ‘º’º’•’¨’µ’°’µ’∂ ID-’∂, ’¥’´’∂’π÷á ’Ø’°’æ’ø’∏÷Ä’´’¶’°÷Å’æ’´
        const app_id = firebaseConfig.projectId; // ’ï’£’ø’°’£’∏÷Ä’Æ’∏÷Ç’¥ ’•’∂÷Ñ projectId-’∂ ’∏÷Ä’∫’•’Ω appId

        // ‘∂’°’¥’¢’µ’∏÷Ç’≤’´ ‘≥’¨’∏’¢’°’¨ ’ä’•’ø’∏÷Ç’©’µ’∏÷Ç’∂ (State)
        let cart = {}; // {productId: {name: '...', price: ..., quantity: 2}}

        // Telegram WebApp-’´ ‘ª’∂’´÷Å’´’°’¨’´’¶’°÷Å’´’°
        const tg = window.Telegram.WebApp;
        tg.ready();

        // ‘ø’∏’≥’°’Ø’∂’•÷Ä’´ ÷á ’è’°÷Ä’°’Æ÷Ñ’∂’•÷Ä’´ ’Ä’≤’∏÷Ç’¥’∂’•÷Ä
        const productsContainer = document.getElementById('products-container');
        const cartSummary = document.getElementById('cart-summary');
        const checkoutButton = document.getElementById('checkout-button');
        const loadingSkeleton = document.getElementById('loading-skeleton');
        const userInfoDisplay = document.getElementById('user-info');
        
        // ----------------------------------------------------
        // ’Ñ’à‘¥‘±‘º ’ñ’à’í’Ü‘ø’ë‘ª‘±
        // ----------------------------------------------------
        function showMessage(text) {
            document.getElementById('modal-text').textContent = text;
            document.getElementById('message-modal').classList.remove('hidden');
        }

        // ----------------------------------------------------
        // 1. FIREBASE ‘ª’Ü‘ª’ë‘ª‘±‘º‘ª‘∂‘±’ë‘ª‘±
        // ----------------------------------------------------
        async function initializeFirebase() {
            try {
                // ‘ª’∂’´÷Å’´’°’¨’´’¶’°÷Å’´’°
                const app = firebase.initializeApp(firebaseConfig);
                db = app.firestore();
                auth = app.auth();

                // ’ï’£’ø’°’£’∏÷Ä’Æ’∏÷Ç’¥ ’•’∂÷Ñ `onAuthStateChanged`-’®’ù ÷Ö’£’ø’°’ø’´÷Ä’∏’ª ID-’∂ ’≥’∑’£÷Ä’ø’•’¨’∏÷Ç ’∞’°’¥’°÷Ä:
                auth.onAuthStateChanged(user => {
                    if (user) {
                        userId = user.uid;
                        console.log("Firebase Auth Ready. User ID:", userId);
                    } else {
                        // ‘±’∂’°’∂’∏÷Ç’∂ ’¥’∏÷Ç’ø÷Ñ
                        auth.signInAnonymously().then(cred => {
                            userId = cred.user.uid;
                            console.log("Signed in anonymously. User ID:", userId);
                        }).catch(error => {
                            console.error("Anonymous Sign In Error:", error);
                            showMessage("’Ä’∂’°÷Ä’°’æ’∏÷Ä ’π’ß ’¥’∏÷Ç’ø÷Ñ ’£’∏÷Ä’Æ’•’¨÷â ‘Ω’∂’§÷Ä’∏÷Ç’¥ ’•’∂÷Ñ ÷É’∏÷Ä’±’•’¨ ’∂’∏÷Ä’´÷Å÷â");
                        });
                    }
                });

                // ’ç’ø’∏÷Ç’£’∏÷Ç’¥ ’•’∂÷Ñ Telegram-’´ ’ø’æ’µ’°’¨’∂’•÷Ä’® ÷á ÷Å’∏÷Ç÷Å’°’§÷Ä’∏÷Ç’¥
                const tgUser = tg.initDataUnsafe.user;
                if (tgUser) {
                    const userName = tgUser.first_name || "‘±’∂’°’∂’∏÷Ç’∂";
                    userInfoDisplay.textContent = `‘≤’°÷Ä÷á, ${userName}`;
                    // ‘µ’©’• Telegram-’´ ID-’∂ ’°’º’Ø’° ’ß, ÷É’∏÷Ä’±’∏÷Ç’¥ ’•’∂÷Ñ ÷Ö’£’ø’°’£’∏÷Ä’Æ’•’¨ ’°’µ’∂
                    // ‘≤’°’µ÷Å Firebase Auth-’® ’°’æ’•’¨’´ ’°’∂’æ’ø’°’∂’£ ’ß ’ø’æ’µ’°’¨’∂’•÷Ä’´ ’¢’°’¶’°’µ’´ ’∞’°’¥’°÷Ä
                }
                
                // ‘≤’•’º’∂’∏÷Ç’¥ ’•’∂÷Ñ ’°’∫÷Ä’°’∂÷Ñ’∂’•÷Ä’® Firebase-’´÷Å
                await fetchProducts();

            } catch (error) {
                console.error("Firebase Initialization Error:", error);
                showMessage(`Firebase-’´ ’´’∂’´÷Å’´’°’¨’´’¶’°÷Å’´’°’µ’´ ’Ω’≠’°’¨÷â ‘ø’∏’§’®: ${error.code}`);
            }
        }

        // ----------------------------------------------------
        // 2. ‘∂‘±’Ñ‘≤’Ö’à’í’Ç‘ª ‘ø‘±’å‘±’é‘±’ê’à’í’Ñ
        // ----------------------------------------------------

        function updateCart(productId, name, price, change) {
            if (!cart[productId]) {
                cart[productId] = { name, price, quantity: 0 };
            }

            cart[productId].quantity += change;

            if (cart[productId].quantity <= 0) {
                delete cart[productId];
            }
            
            // ‘π’°÷Ä’¥’°÷Å’∂’∏÷Ç’¥ ’•’∂÷Ñ UI-’®
            renderCartSummary();
            renderProductQuantities();
        }

        function renderCartSummary() {
            let totalItems = 0;
            let totalPrice = 0;

            for (const id in cart) {
                totalItems += cart[id].quantity;
                totalPrice += cart[id].quantity * cart[id].price;
            }

            if (totalItems > 0) {
                cartSummary.innerHTML = `‘∂’°’¥’¢’µ’∏÷Ç’≤: <b>${totalItems}</b> ’°’∫÷Ä’°’∂÷Ñ, <b>${totalPrice.toFixed(0)} ‘¥’ê</b>`;
                checkoutButton.disabled = false;
                checkoutButton.classList.remove('opacity-50', 'cursor-not-allowed');
                // ’ë’∏÷Ç÷Å’°’§÷Ä’∏÷Ç’¥ ’•’∂÷Ñ Telegram-’´ ’∞’´’¥’∂’°’Ø’°’∂ ’Ø’∏’≥’°’Ø’®
                tg.MainButton.setText(`’é’É‘±’ê‘µ‘º ${totalPrice.toFixed(0)} ‘¥’ê`).show();
                
            } else {
                cartSummary.textContent = "‘∂’°’¥’¢’µ’∏÷Ç’≤’® ’§’°’ø’°÷Ä’Ø ’ß";
                checkoutButton.disabled = true;
                checkoutButton.classList.add('opacity-50', 'cursor-not-allowed');
                tg.MainButton.hide();
            }
        }
        
        function renderProductQuantities() {
            // ‘±’µ’Ω ÷Ü’∏÷Ç’∂’Ø÷Å’´’°’∂ ’∫’•’ø÷Ñ ’ß ’©’°÷Ä’¥’°÷Å’∂’´ ’µ’∏÷Ç÷Ä’°÷Ñ’°’∂’π’µ’∏÷Ç÷Ä ’°’∫÷Ä’°’∂÷Ñ’´ ÷Ñ’°’∂’°’Ø’® UI-’∏÷Ç’¥
            for (const id in cart) {
                const qtyElement = document.getElementById(`qty-${id}`);
                if (qtyElement) {
                    qtyElement.textContent = cart[id].quantity;
                }
            }
        }

        // ----------------------------------------------------
        // 3. ’è’é’Ö‘±‘º’Ü‘µ’ê‘ª ‘≤‘µ’å’Ü’à’í’Ñ ‘µ’é ’ë’à’í’ë‘±‘¥’ê’à’í’Ñ
        // ----------------------------------------------------

        async function fetchProducts() {
            // ‘ø’°÷Ä’§’∏÷Ç’¥ ’•’∂÷Ñ ’°’∫÷Ä’°’∂÷Ñ’∂’•÷Ä’® Firestore-’´ ’∞’°’∂÷Ä’°’µ’´’∂ ’∞’°’æ’°÷Ñ’°’Æ’∏÷Ç’´÷Å
            const path = `artifacts/${app_id}/public/data/products`;
            try {
                // ‘π’°÷Ñ÷Å’∂’∏÷Ç’¥ ’•’∂÷Ñ ’Ω’Ø’•’¨’•’ø’∏’∂’® ’¢’•’º’∂’∏÷Ç’¥’´÷Å ’°’º’°’ª
                loadingSkeleton.classList.remove('hidden');
                
                const productsRef = db.collection(path);
                const snapshot = await productsRef.get();
                
                // ’Ñ’°÷Ñ÷Ä’∏÷Ç’¥ ’•’∂÷Ñ ’Ø’∏’∂’ø’•’µ’∂’•÷Ä’® ’∂’°’≠÷Ñ’°’∂ ’∂’∏÷Ä ’°’∫÷Ä’°’∂÷Ñ’∂’•÷Ä ’°’æ’•’¨’°÷Å’∂’•’¨’®
                productsContainer.innerHTML = '';
                
                if (snapshot.empty) {
                    productsContainer.innerHTML = `
                        <div class="col-span-full text-center py-12 text-gray-500">
                            ‘±’∫÷Ä’°’∂÷Ñ’∂’•÷Ä ’π’Ø’°’∂÷â ‘Ω’∂’§÷Ä’∏÷Ç’¥ ’•’∂÷Ñ ’°’æ’•’¨’°÷Å’∂’•’¨ ’¥’∏÷Ñ ’ø’æ’µ’°’¨’∂’•÷Ä Firestore-’∏÷Ç’¥÷â
                            <button id="seed-data" class="main-button mt-4 px-4 py-2 rounded-full text-sm">‘±’æ’•’¨’°÷Å’∂’•’¨ ’ï÷Ä’´’∂’°’Ø’•’¨’´ ‘±’∫÷Ä’°’∂÷Ñ’∂’•÷Ä</button>
                        </div>
                    `;
                    document.getElementById('seed-data').addEventListener('click', seedData);
                    return;
                }
                
                snapshot.forEach(doc => {
                    const product = doc.data();
                    product.id = doc.id;
                    renderProductCard(product);
                });
                
            } catch (error) {
                console.error("Error fetching products:", error);
                productsContainer.innerHTML = `<div class="col-span-full text-center py-12 text-red-500">’ç’≠’°’¨’ù ’°’∫÷Ä’°’∂÷Ñ’∂’•÷Ä’® ’¢’•’º’∂’•’¨’´’Ω: ${error.message}</div>`;
            } finally {
                loadingSkeleton.classList.add('hidden');
            }
        }
        
        function renderProductCard(product) {
            const currentQty = cart[product.id] ? cart[product.id].quantity : 0;
            
            const card = document.createElement('div');
            card.className = "product-card shadow-lg p-3 rounded-xl flex flex-col justify-between border border-gray-200";
            card.innerHTML = `
                <img src="${product.imageUrl || 'https://placehold.co/400x300/e0f2fe/0369a1?text=WB'}" 
                     onerror="this.onerror=null; this.src='https://placehold.co/400x300/e0f2fe/0369a1?text=WB';"
                     alt="${product.name}" class="w-full h-28 object-cover rounded-lg mb-2">
                <h3 class="font-bold text-base mb-1 truncate">${product.name}</h3>
                <p class="text-xs text-gray-500 mb-2">${product.description || '’Ä’´’°’∂’°’¨’´ ’°’∫÷Ä’°’∂÷Ñ'}</p>
                <div class="font-extrabold text-lg text-blue-600 mb-3">${product.price.toFixed(0)} ‘¥’ê</div>

                <div class="flex justify-between items-center bg-gray-100 p-2 rounded-full">
                    <button class="text-red-500 p-1 rounded-full hover:bg-red-100 transition" 
                            data-product-id="${product.id}" 
                            data-product-name="${product.name}" 
                            data-product-price="${product.price}" 
                            data-action="remove">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5 10a1 1 0 011-1h8a1 1 0 110 2H6a1 1 0 01-1-1z" clip-rule="evenodd" /></svg>
                    </button>
                    <span id="qty-${product.id}" class="font-bold text-lg w-6 text-center">${currentQty}</span>
                    <button class="text-green-500 p-1 rounded-full hover:bg-green-100 transition" 
                            data-product-id="${product.id}" 
                            data-product-name="${product.name}" 
                            data-product-price="${product.price}" 
                            data-action="add">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z" clip-rule="evenodd" /></svg>
                    </button>
                </div>
            `;
            productsContainer.appendChild(card);
            
            // ‘±’æ’•’¨’°÷Å’∂’∏÷Ç’¥ ’•’∂÷Ñ event listener-’∂’•÷Ä ’Ø’∏’≥’°’Ø’∂’•÷Ä’´’∂
            card.querySelectorAll('button').forEach(button => {
                button.addEventListener('click', (e) => {
                    const { productId, productName, productPrice, action } = e.currentTarget.dataset;
                    const priceNum = parseFloat(productPrice);

                    if (action === 'add') {
                        updateCart(productId, productName, priceNum, 1);
                    } else if (action === 'remove') {
                        updateCart(productId, productName, priceNum, -1);
                    }
                });
            });
        }
        
        // ----------------------------------------------------
        // 4. ’Ñ’à’î ’è’é’Ö‘±‘º’Ü‘µ’ê‘ª ‘±’é‘µ‘º‘±’ë’à’í’Ñ (SEED DATA)
        // ----------------------------------------------------
        
        async function seedData() {
            const mockProducts = [
                { name: "‘±’¥’°’º’°’µ’´’∂ ‘∂’£’•’Ω’ø", price: 9500, description: "‘π’•’©÷á, ’¢’°’¥’¢’°’Ø’µ’° ’¶’£’•’Ω’ø÷â", imageUrl: "https://placehold.co/400x300/a3e635/166534?text=Dress" },
                { name: "’ç’∫’∏÷Ä’ø’°’µ’´’∂ ‘ø’∏’∑’´’Ø’∂’•÷Ä", price: 18000, description: "’Ä’°÷Ä’¥’°÷Ä’°’æ’•’ø ’æ’°’¶÷Ñ’´ ’∞’°’¥’°÷Ä÷â", imageUrl: "https://placehold.co/400x300/4ade80/065f46?text=Shoes" },
                { name: "‘±’∂’ª÷Ä’°’∂÷Å’´’Ø ‘∫’°’¥’°÷Å’∏÷Ç’µ÷Å", price: 12500, description: "‘µ÷Ä’Ø’°÷Ä’°’Ø’µ’°÷Å, ’Ω’∫’∏÷Ä’ø’°’µ’´’∂ ’¥’∏’§’•’¨÷â", imageUrl: "https://placehold.co/400x300/34d399/047857?text=Watch" },
                { name: "‘≤’°’≥’Ø’∏’∂", price: 29990, description: "’è’°÷Ñ, ’±’¥’•’º’°’µ’´’∂ ’¢’°’≥’Ø’∏’∂÷â", imageUrl: "https://placehold.co/400x300/6ee7b7/059669?text=Jacket" }
            ];
            
            const path = `artifacts/${app_id}/public/data/products`;
            const batch = db.batch();
            
            try {
                // ’Ü’°’≠’ù ’ª’∂’ª’∏÷Ç’¥ ’•’∂÷Ñ ’∞’´’∂ ’°’∫÷Ä’°’∂÷Ñ’∂’•÷Ä’®
                const snapshot = await db.collection(path).get();
                snapshot.docs.forEach(doc => batch.delete(doc.ref));

                // ‘±’æ’•’¨’°÷Å’∂’∏÷Ç’¥ ’•’∂÷Ñ ’∂’∏÷Ä’•÷Ä’®
                mockProducts.forEach((product, index) => {
                    const docRef = db.collection(path).doc(`prod_${index + 1}`);
                    batch.set(docRef, product);
                });
                
                await batch.commit();
                showMessage("’ï÷Ä’´’∂’°’Ø’•’¨’´ ’°’∫÷Ä’°’∂÷Ñ’∂’•÷Ä’∂ ’°’æ’•’¨’°÷Å’æ’•÷Å’´’∂÷â ‘Ω’∂’§÷Ä’∏÷Ç’¥ ’•’∂÷Ñ ’©’°÷Ä’¥’°÷Å’∂’•’¨ ’ß’ª’®÷â");
                fetchProducts(); // ‘π’°÷Ä’¥’°÷Å’∂’∏÷Ç’¥ ’•’∂÷Ñ ’°’∫÷Ä’°’∂÷Ñ’∂’•÷Ä’´ ÷Å’∏÷Ç÷Å’°’Ø’®
                
            } catch (error) {
                console.error("Error seeding data:", error);
                showMessage(`’ç’≠’°’¨’ù ’ø’æ’µ’°’¨’∂’•÷Ä’∂ ’°’æ’•’¨’°÷Å’∂’•’¨’´’Ω: ${error.message}`);
            }
        }


        // ----------------------------------------------------
        // 5. ’é’É‘±’ê’Ñ‘±’Ü ‘≥’à’ê‘æ‘∏’Ü‘π‘±’ë‘ª ’Ñ‘µ‘ø’Ü‘±’ê‘ø
        // ----------------------------------------------------
        
        function startCheckout() {
            // ’ä’°’ø÷Ä’°’Ω’ø’∏÷Ç’¥ ’•’∂÷Ñ ’¶’°’¥’¢’µ’∏÷Ç’≤’´ ’ø’æ’µ’°’¨’∂’•÷Ä’®, ’∏÷Ä’∏’∂÷Ñ ’Ø’∏÷Ç’≤’°÷Ä’Ø’æ’•’∂ ’¢’∏’ø’´’∂
            const cartArray = Object.keys(cart).map(id => ({
                id: id,
                name: cart[id].name,
                price: cart[id].price,
                quantity: cart[id].quantity
            }));

            // ’ì’∏’≠’°÷Ä’Ø’∏÷Ç’¥ ’•’∂÷Ñ JSON ’ø’∏’≤’´
            const cartJson = JSON.stringify(cartArray);
            
            // ’à÷Ç’≤’°÷Ä’Ø’∏÷Ç’¥ ’•’∂÷Ñ ’ø’æ’µ’°’¨’∂’•÷Ä’® Telegram ‘≤’∏’ø’´’∂’ù ’æ’≥’°÷Ä’∏÷Ç’¥’® ’Ω’Ø’Ω’•’¨’∏÷Ç ’∞’°’¥’°÷Ä:
            // ‘≤’∏’ø’´ backend-’® (main.py) ’Ø’Ω’ø’°’∂’° ’°’µ’Ω ’ø’æ’µ’°’¨’∂’•÷Ä’® ’∏÷Ä’∫’•’Ω web_app_data
            tg.sendData(cartJson);
            
            // ‘∫’°’¥’°’∂’°’Ø’°’æ’∏÷Ä’°’∫’•’Ω ÷Å’∏÷Ç÷Å’°’§÷Ä’∏÷Ç’¥ ’•’∂÷Ñ ’∞’°’≤’∏÷Ä’§’°’£÷Ä’∏÷Ç’©’µ’∏÷Ç’∂
            showMessage("’ä’°’ø’æ’•÷Ä’´ ’ø’æ’µ’°’¨’∂’•÷Ä’® ’∏÷Ç’≤’°÷Ä’Ø’æ’•’¨ ’•’∂ ‘≤’∏’ø’´’∂÷â ‘Ω’∂’§÷Ä’∏÷Ç’¥ ’•’∂÷Ñ ’∞’•’ø÷á’•’¨ ‘≤’∏’ø’´ ’π’°’©’´’∂÷â");
        }

        // ‘ø÷Å’∏÷Ç’¥ ’•’∂÷Ñ event listener-’∂’•÷Ä’®
        checkoutButton.addEventListener('click', startCheckout);
        tg.MainButton.onClick(startCheckout);


        // ‘≥’∏÷Ä’Æ’°÷Ä’Ø’∏÷Ç’¥ ’•’∂÷Ñ ’´’∂’´÷Å’´’°’¨’´’¶’°÷Å’´’°’∂, ’•÷Ä’¢ ’ß’ª’® ’¢’•’º’∂’æ’°’Æ ’ß
        window.onload = initializeFirebase;
    </script>
</body>
</html>
