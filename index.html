<!DOCTYPE html>
<html lang="hy">
<head>
ย ย <meta charset="UTF-8">
ย ย <meta name="viewport" content="width=device-width, initial-scale=1.0">
ย ย <title>Wildberries ิฝีกีถีธึีฉ</title>
ย ย ย ย <script src="https://cdn.tailwindcss.com"></script>
ย ย ย ย <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet">
ย ย <style>
ย ย ย ย body {
ย ย ย ย ย ย font-family: 'Inter', sans-serif;
ย ย ย ย ย ย background-color: var(--tg-theme-bg-color, #f4f4f4); /* Telegram ึีธีถีซ ีฃีธึีตีถ */
ย ย ย ย ย ย color: var(--tg-theme-text-color, #333);
ย ย ย ย ย ย transition: background-color 0.3s, color 0.3s;
ย ย ย ย }
ย ย ย ย .header, .footer {
ย ย ย ย ย ย background-color: var(--tg-theme-secondary-bg-color, #ffffff); /* ิตึีฏึีธึีคีกีฏีกีถ ึีธีถีซ ีฃีธึีตีถ */
ย ย ย ย }
ย ย ย ย .main-button {
ย ย ย ย ย ย background-color: var(--tg-theme-button-color, #007bff);
ย ย ย ย ย ย color: var(--tg-theme-button-text-color, #ffffff);
ย ย ย ย ย ย transition: background-color 0.2s;
ย ย ย ย }
ย ย ย ย .main-button:active {
ย ย ย ย ย ย filter: brightness(0.9);
ย ย ย ย }
ย ย ย ย .product-card {
ย ย ย ย ย ย border-color: var(--tg-theme-secondary-bg-color, #e5e7eb);
ย ย ย ย }
ย ย ย ย .skeleton {
ย ย ย ย ย ย animation: pulse 1.5s infinite;
ย ย ย ย }
ย ย ย ย @keyframes pulse {
ย ย ย ย ย ย 0%, 100% { opacity: 1; }
ย ย ย ย ย ย 50% { opacity: 0.5; }
ย ย ย ย }
ย ย </style>
</head>
<body>
ย ย 
ย ย <div id="app" class="min-h-screen flex flex-col">
ย ย ย ย ย ย ย ย <div class="header shadow-md p-4 sticky top-0 z-10 flex justify-between items-center rounded-b-xl">
ย ย ย ย ย ย <h1 class="text-xl font-bold">Wildberries ิฝีกีถีธึีฉ ๐๏ธ</h1>
ย ย ย ย ย ย <div id="user-info" class="text-sm"></div>
ย ย ย ย </div>

ย ย ย ย ย ย ย ย <main class="flex-grow p-4 grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4" id="products-container">
ย ย ย ย ย ย ย ย ย ย ย ย 
ย ย ย ย ย ย ย ย ย ย ย ย <div id="loading-skeleton" class="col-span-2 md:col-span-3 lg:col-span-4 grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
ย ย ย ย ย ย ย ย <div class="product-card bg-gray-200 shadow-lg p-3 rounded-xl skeleton h-64"></div>
ย ย ย ย ย ย ย ย <div class="product-card bg-gray-200 shadow-lg p-3 rounded-xl skeleton h-64"></div>
ย ย ย ย ย ย ย ย <div class="product-card bg-gray-200 shadow-lg p-3 rounded-xl skeleton h-64"></div>
ย ย ย ย ย ย ย ย <div class="product-card bg-gray-200 shadow-lg p-3 rounded-xl skeleton h-64 hidden md:block"></div>
ย ย ย ย ย ย </div>

ย ย ย ย </main>
        
        <div class="p-4 bg-yellow-50 shadow-inner mt-4 rounded-xl border border-yellow-200">
            <h3 class="text-lg font-bold mb-3 text-yellow-800">๐ค ีีฅีึ ีฃีฟีถีธึีด ีีฅึ ีธึีฆีกีฎ ีกีบึีกีถึีจ</h3>
            <p class="text-sm text-gray-600 mb-3">ีึีฒีกึีฏีฅึ ีดีฅีฆ ึีกีถีฏีกีฌีซ ีกีบึีกีถึีซ ีกีถีธึีถีจ ึ ีฐีฒีธึีดีจ (Wildberries-ีซึ ีฏีกีด ีกีตีฌ ีฟีฅีฒีซึ), ึ ีดีฅีถึ ีฏีกีพีฅีฌีกึีถีฅีถึ ีกีตีถึ</p>
            
            <input type="text" id="request-name" placeholder="ิฑีบึีกีถึีซ ีกีถีธึีถ/ีถีฏีกึีกีฃึีธึีฉีตีธึีถ" class="w-full p-2 border border-gray-300 rounded-lg mb-2 text-gray-800">
            <input type="url" id="request-link" placeholder="ีีฒีธึีด (Link, ีจีฝีฟ ึีกีถีฏีธึีฉีตีกีถ)" class="w-full p-2 border border-gray-300 rounded-lg mb-4 text-gray-800">
            
            <button id="send-request-button" class="main-button w-full px-4 py-2 rounded-full font-semibold shadow-md">
                ีึีฒีกึีฏีฅีฌ ีีกีตีฟีจ ๐
            </button>
        </div>
        ย ย ย ย ย ย ย ย <div class="footer shadow-t-lg p-4 sticky bottom-0 z-10 rounded-t-xl">
ย ย ย ย ย ย <div class="flex justify-between items-center">
ย ย ย ย ย ย ย ย <div id="cart-summary" class="text-lg font-semibold">ิถีกีดีขีตีธึีฒีจ ีคีกีฟีกึีฏ ีง</div>
ย ย ย ย ย ย ย ย <button id="checkout-button" class="main-button px-6 py-3 rounded-full font-bold shadow-lg opacity-50 cursor-not-allowed" disabled>
ย ย ย ย ย ย ย ย ย ย ีีณีกึีฅีฌ
ย ย ย ย ย ย ย ย </button>
ย ย ย ย ย ย </div>
ย ย ย ย </div>

ย ย ย ย ย ย ย ย <div id="message-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
ย ย ย ย ย ย <div class="bg-white p-6 rounded-xl shadow-2xl max-w-sm w-full text-center">
ย ย ย ย ย ย ย ย <p id="modal-text" class="text-gray-800 font-semibold"></p>
ย ย ย ย ย ย ย ย <button onclick="document.getElementById('message-modal').classList.add('hidden')" class="main-button mt-4 px-4 py-2 rounded-full text-sm">ีีกีฏีฅีฌ</button>
ย ย ย ย ย ย </div>
ย ย ย ย </div>
ย ย </div>

ย ย ย ย <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
ย ย <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>
ย ย <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>
ย ย 
ย ย ย ย <script src="https://telegram.org/js/telegram-web-app.js"></script>

ย ย <script>
ย ย ย ย // ีีฅึ ีฟึีกีดีกีคึีกีฎ Firebase-ีซ ิฟีธีถึีซีฃีธึึีกึีซีกีถ
ย ย ย ย const firebaseConfig = {
ย ย ย ย ย ย apiKey: "AIzaSyCXp9sfT5rTtKQX95wQi13ZGhfEbqNeMxQ",
ย ย ย ย ย ย authDomain: "wildberries-shop.firebaseapp.com",
ย ย ย ย ย ย projectId: "wildberries-shop",
ย ย ย ย ย ย storageBucket: "wildberries-shop.firebasestorage.app",
ย ย ย ย ย ย messagingSenderId: "461291386921",
ย ย ย ย ย ย appId: "1:461291386921:web:970ed17cf9a25893354438",
ย ย ย ย ย ย measurementId: "G-EYGVT824J5"
ย ย ย ย };

ย ย ย ย // ิณีฌีธีขีกีฌ ีีธึีธีญีกีฏีกีถีถีฅึ
ย ย ย ย let db;
ย ย ย ย let auth;
ย ย ย ย let userId = 'anon_user_' + Date.now(); // ิผีผีฅีฌีตีกีตีถ ID-ีถ, ีดีซีถีนึ ีฏีกีพีฟีธึีซีฆีกึีพีซ
ย ย ย ย const app_id = firebaseConfig.projectId; // ีีฃีฟีกีฃีธึีฎีธึีด ีฅีถึ projectId-ีถ ีธึีบีฅีฝ appId

ย ย ย ย // ิถีกีดีขีตีธึีฒีซ ิณีฌีธีขีกีฌ ีีฅีฟีธึีฉีตีธึีถ (State)
ย ย ย ย let cart = {}; // {productId: {name: '...', price: ..., quantity: 2}}

ย ย ย ย // Telegram WebApp-ีซ ิปีถีซึีซีกีฌีซีฆีกึีซีก
ย ย ย ย const tg = window.Telegram.WebApp;
ย ย ย ย tg.ready();

ย ย ย ย // ิฟีธีณีกีฏีถีฅึีซ ึ ีีกึีกีฎึีถีฅึีซ ีีฒีธึีดีถีฅึ
ย ย ย ย const productsContainer = document.getElementById('products-container');
ย ย ย ย const cartSummary = document.getElementById('cart-summary');
ย ย ย ย const checkoutButton = document.getElementById('checkout-button');
ย ย ย ย const loadingSkeleton = document.getElementById('loading-skeleton');
ย ย ย ย const userInfoDisplay = document.getElementById('user-info');
ย ย ย ย 
ย ย ย ย // ----------------------------------------------------
ย ย ย ย // ีีิดิฑิผ ีีีีิฟีิปิฑ
ย ย ย ย // ----------------------------------------------------
ย ย ย ย function showMessage(text) {
ย ย ย ย ย ย document.getElementById('modal-text').textContent = text;
ย ย ย ย ย ย document.getElementById('message-modal').classList.remove('hidden');
ย ย ย ย }

ย ย ย ย // ----------------------------------------------------
ย ย ย ย // 1. FIREBASE ิปีิปีิปิฑิผิปิถิฑีิปิฑ
ย ย ย ย // ----------------------------------------------------
ย ย ย ย async function initializeFirebase() {
ย ย ย ย ย ย try {
ย ย ย ย ย ย ย ย // ิปีถีซึีซีกีฌีซีฆีกึีซีก
ย ย ย ย ย ย ย ย const app = firebase.initializeApp(firebaseConfig);
ย ย ย ย ย ย ย ย db = app.firestore();
ย ย ย ย ย ย ย ย auth = app.auth();

ย ย ย ย ย ย ย ย // ีีฃีฟีกีฃีธึีฎีธึีด ีฅีถึ `onAuthStateChanged`-ีจี ึีฃีฟีกีฟีซึีธีป ID-ีถ ีณีทีฃึีฟีฅีฌีธึ ีฐีกีดีกึ:
ย ย ย ย ย ย ย ย auth.onAuthStateChanged(user => {
ย ย ย ย ย ย ย ย ย ย if (user) {
ย ย ย ย ย ย ย ย ย ย ย ย userId = user.uid;
ย ย ย ย ย ย ย ย ย ย ย ย console.log("Firebase Auth Ready. User ID:", userId);
ย ย ย ย ย ย ย ย ย ย } else {
ย ย ย ย ย ย ย ย ย ย ย ย // ิฑีถีกีถีธึีถ ีดีธึีฟึ
ย ย ย ย ย ย ย ย ย ย ย ย auth.signInAnonymously().then(cred => {
ย ย ย ย ย ย ย ย ย ย ย ย ย ย userId = cred.user.uid;
ย ย ย ย ย ย ย ย ย ย ย ย ย ย console.log("Signed in anonymously. User ID:", userId);
ย ย ย ย ย ย ย ย ย ย ย ย }).catch(error => {
ย ย ย ย ย ย ย ย ย ย ย ย ย ย console.error("Anonymous Sign In Error:", error);
ย ย ย ย ย ย ย ย ย ย ย ย ย ย showMessage("ีีถีกึีกีพีธึ ีนีง ีดีธึีฟึ ีฃีธึีฎีฅีฌึ ิฝีถีคึีธึีด ีฅีถึ ึีธึีฑีฅีฌ ีถีธึีซึึ");
ย ย ย ย ย ย ย ย ย ย ย ย });
ย ย ย ย ย ย ย ย ย ย }
ย ย ย ย ย ย ย ย });

ย ย ย ย ย ย ย ย // ีีฟีธึีฃีธึีด ีฅีถึ Telegram-ีซ ีฟีพีตีกีฌีถีฅึีจ ึ ึีธึึีกีคึีธึีด
ย ย ย ย ย ย ย ย const tgUser = tg.initDataUnsafe.user;
ย ย ย ย ย ย ย ย if (tgUser) {
ย ย ย ย ย ย ย ย ย ย const userName = tgUser.first_name || "ิฑีถีกีถีธึีถ";
ย ย ย ย ย ย ย ย ย ย userInfoDisplay.textContent = `ิฒีกึึ, ${userName}`;
ย ย ย ย ย ย ย ย ย ย // ิตีฉีฅ Telegram-ีซ ID-ีถ ีกีผีฏีก ีง, ึีธึีฑีธึีด ีฅีถึ ึีฃีฟีกีฃีธึีฎีฅีฌ ีกีตีถ
ย ย ย ย ย ย ย ย ย ย // ิฒีกีตึ Firebase Auth-ีจ ีกีพีฅีฌีซ ีกีถีพีฟีกีถีฃ ีง ีฟีพีตีกีฌีถีฅึีซ ีขีกีฆีกีตีซ ีฐีกีดีกึ
ย ย ย ย ย ย ย ย }
ย ย ย ย ย ย ย ย 
ย ย ย ย ย ย ย ย // ิฒีฅีผีถีธึีด ีฅีถึ ีกีบึีกีถึีถีฅึีจ Firebase-ีซึ
ย ย ย ย ย ย ย ย await fetchProducts();

ย ย ย ย ย ย } catch (error) {
ย ย ย ย ย ย ย ย console.error("Firebase Initialization Error:", error);
ย ย ย ย ย ย ย ย showMessage(`Firebase-ีซ ีซีถีซึีซีกีฌีซีฆีกึีซีกีตีซ ีฝีญีกีฌึ ิฟีธีคีจ: ${error.code}`);
ย ย ย ย ย ย }
ย ย ย ย }

ย ย ย ย // ----------------------------------------------------
ย ย ย ย // 2. ิถิฑีิฒีีีีิป ิฟิฑีิฑีิฑีีีี
ย ย ย ย // ----------------------------------------------------

ย ย ย ย function updateCart(productId, name, price, change) {
ย ย ย ย ย ย if (!cart[productId]) {
ย ย ย ย ย ย ย ย cart[productId] = { name, price, quantity: 0 };
ย ย ย ย ย ย }

ย ย ย ย ย ย cart[productId].quantity += change;

ย ย ย ย ย ย if (cart[productId].quantity <= 0) {
ย ย ย ย ย ย ย ย delete cart[productId];
ย ย ย ย ย ย }
ย ย ย ย ย ย 
ย ย ย ย ย ย // ินีกึีดีกึีถีธึีด ีฅีถึ UI-ีจ
ย ย ย ย ย ย renderCartSummary();
ย ย ย ย ย ย renderProductQuantities();
ย ย ย ย }

ย ย ย ย function renderCartSummary() {
ย ย ย ย ย ย let totalItems = 0;
ย ย ย ย ย ย let totalPrice = 0;

ย ย ย ย ย ย for (const id in cart) {
ย ย ย ย ย ย ย ย totalItems += cart[id].quantity;
ย ย ย ย ย ย ย ย totalPrice += cart[id].quantity * cart[id].price;
ย ย ย ย ย ย }

ย ย ย ย ย ย if (totalItems > 0) {
ย ย ย ย ย ย ย ย cartSummary.innerHTML = `ิถีกีดีขีตีธึีฒ: <b>${totalItems}</b> ีกีบึีกีถึ, <b>${totalPrice.toFixed(0)} ิดี</b>`;
ย ย ย ย ย ย ย ย checkoutButton.disabled = false;
ย ย ย ย ย ย ย ย checkoutButton.classList.remove('opacity-50', 'cursor-not-allowed');
ย ย ย ย ย ย ย ย // ีีธึึีกีคึีธึีด ีฅีถึ Telegram-ีซ ีฐีซีดีถีกีฏีกีถ ีฏีธีณีกีฏีจ
ย ย ย ย ย ย ย ย tg.MainButton.setText(`ีีิฑีิติผ ${totalPrice.toFixed(0)} ิดี`).show();
ย ย ย ย ย ย ย ย 
ย ย ย ย ย ย } else {
ย ย ย ย ย ย ย ย cartSummary.textContent = "ิถีกีดีขีตีธึีฒีจ ีคีกีฟีกึีฏ ีง";
ย ย ย ย ย ย ย ย checkoutButton.disabled = true;
ย ย ย ย ย ย ย ย checkoutButton.classList.add('opacity-50', 'cursor-not-allowed');
ย ย ย ย ย ย ย ย tg.MainButton.hide();
ย ย ย ย ย ย }
ย ย ย ย }
ย ย ย ย 
ย ย ย ย function renderProductQuantities() {
ย ย ย ย ย ย // ิฑีตีฝ ึีธึีถีฏึีซีกีถ ีบีฅีฟึ ีง ีฉีกึีดีกึีถีซ ีตีธึึีกึีกีถีนีตีธึึ ีกีบึีกีถึีซ ึีกีถีกีฏีจ UI-ีธึีด
ย ย ย ย ย ย for (const id in cart) {
ย ย ย ย ย ย ย ย const qtyElement = document.getElementById(`qty-${id}`);
ย ย ย ย ย ย ย ย if (qtyElement) {
ย ย ย ย ย ย ย ย ย ย qtyElement.textContent = cart[id].quantity;
ย ย ย ย ย ย ย ย }
ย ย ย ย ย ย }
ย ย ย ย }

ย ย ย ย // ----------------------------------------------------
ย ย ย ย // 3. ีีีิฑิผีิตีิป ิฒิตีีีีี ิตี ีีีีิฑิดีีีี
ย ย ย ย // ----------------------------------------------------

ย ย ย ย async function fetchProducts() {
ย ย ย ย ย ย // ิฟีกึีคีธึีด ีฅีถึ ีกีบึีกีถึีถีฅึีจ Firestore-ีซ ีฐีกีถึีกีตีซีถ ีฐีกีพีกึีกีฎีธึีซึ
ย ย ย ย ย ย const path = `artifacts/${app_id}/public/data/products`;
ย ย ย ย ย ย try {
ย ย ย ย ย ย ย ย // ินีกึึีถีธึีด ีฅีถึ ีฝีฏีฅีฌีฅีฟีธีถีจ ีขีฅีผีถีธึีดีซึ ีกีผีกีป
ย ย ย ย ย ย ย ย loadingSkeleton.classList.remove('hidden');
ย ย ย ย ย ย ย ย 
ย ย ย ย ย ย ย ย const productsRef = db.collection(path);
ย ย ย ย ย ย ย ย const snapshot = await productsRef.get();
ย ย ย ย ย ย ย ย 
ย ย ย ย ย ย ย ย // ีีกึึีธึีด ีฅีถึ ีฏีธีถีฟีฅีตีถีฅึีจ ีถีกีญึีกีถ ีถีธึ ีกีบึีกีถึีถีฅึ ีกีพีฅีฌีกึีถีฅีฌีจ
ย ย ย ย ย ย ย ย productsContainer.innerHTML = '';
ย ย ย ย ย ย ย ย 
ย ย ย ย ย ย ย ย if (snapshot.empty) {
ย ย ย ย ย ย ย ย ย ย productsContainer.innerHTML = `
ย ย ย ย ย ย ย ย ย ย ย ย <div class="col-span-full text-center py-12 text-gray-500">
ย ย ย ย ย ย ย ย ย ย ย ย ย ย ิฑีบึีกีถึีถีฅึ ีนีฏีกีถึ ิฝีถีคึีธึีด ีฅีถึ ีกีพีฅีฌีกึีถีฅีฌ ีดีธึ ีฟีพีตีกีฌีถีฅึ Firestore-ีธึีดึ
ย ย ย ย ย ย ย ย ย ย ย ย ย ย <button id="seed-data" class="main-button mt-4 px-4 py-2 rounded-full text-sm">ิฑีพีฅีฌีกึีถีฅีฌ ีึีซีถีกีฏีฅีฌีซ ิฑีบึีกีถึีถีฅึ</button>
ย ย ย ย ย ย ย ย ย ย ย ย </div>
ย ย ย ย ย ย ย ย ย ย `;
ย ย ย ย ย ย ย ย ย ย document.getElementById('seed-data').addEventListener('click', seedData);
ย ย ย ย ย ย ย ย ย ย return;
ย ย ย ย ย ย ย ย }
ย ย ย ย ย ย ย ย 
ย ย ย ย ย ย ย ย snapshot.forEach(doc => {
ย ย ย ย ย ย ย ย ย ย const product = doc.data();
ย ย ย ย ย ย ย ย ย ย product.id = doc.id;
ย ย ย ย ย ย ย ย ย ย renderProductCard(product);
ย ย ย ย ย ย ย ย });
ย ย ย ย ย ย ย ย 
ย ย ย ย ย ย } catch (error) {
ย ย ย ย ย ย ย ย console.error("Error fetching products:", error);
ย ย ย ย ย ย ย ย productsContainer.innerHTML = `<div class="col-span-full text-center py-12 text-red-500">ีีญีกีฌี ีกีบึีกีถึีถีฅึีจ ีขีฅีผีถีฅีฌีซีฝ: ${error.message}</div>`;
ย ย ย ย ย ย } finally {
ย ย ย ย ย ย ย ย loadingSkeleton.classList.add('hidden');
ย ย ย ย ย ย }
ย ย ย ย }
ย ย ย ย 
ย ย ย ย function renderProductCard(product) {
ย ย ย ย ย ย const currentQty = cart[product.id] ? cart[product.id].quantity : 0;
ย ย ย ย ย ย 
ย ย ย ย ย ย const card = document.createElement('div');
ย ย ย ย ย ย card.className = "product-card shadow-lg p-3 rounded-xl flex flex-col justify-between border border-gray-200";
ย ย ย ย ย ย card.innerHTML = `
ย ย ย ย ย ย ย ย <img src="${product.imageUrl || 'https://placehold.co/400x300/e0f2fe/0369a1?text=WB'}" 
ย ย ย ย ย ย ย ย ย ย ยonerror="this.onerror=null; this.src='https://placehold.co/400x300/e0f2fe/0369a1?text=WB';"
ย ย ย ย ย ย ย ย ย ย ยalt="${product.name}" class="w-full h-28 object-cover rounded-lg mb-2">
ย ย ย ย ย ย ย ย <h3 class="font-bold text-base mb-1 truncate">${product.name}</h3>
ย ย ย ย ย ย ย ย <p class="text-xs text-gray-500 mb-2">${product.description || 'ีีซีกีถีกีฌีซ ีกีบึีกีถึ'}</p>
ย ย ย ย ย ย ย ย <div class="font-extrabold text-lg text-blue-600 mb-3">${product.price.toFixed(0)} ิดี</div>

ย ย ย ย ย ย ย ย <div class="flex justify-between items-center bg-gray-100 p-2 rounded-full">
ย ย ย ย ย ย ย ย ย ย <button class="text-red-500 p-1 rounded-full hover:bg-red-100 transition" 
ย ย ย ย ย ย ย ย ย ย ย ย ย ย data-product-id="${product.id}" 
ย ย ย ย ย ย ย ย ย ย ย ย ย ย data-product-name="${product.name}" 
ย ย ย ย ย ย ย ย ย ย ย ย ย ย data-product-price="${product.price}" 
ย ย ย ย ย ย ย ย ย ย ย ย ย ย data-action="remove">
ย ย ย ย ย ย ย ย ย ย ย ย <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5 10a1 1 0 011-1h8a1 1 0 110 2H6a1 1 0 01-1-1z" clip-rule="evenodd" /></svg>
ย ย ย ย ย ย ย ย ย ย </button>
ย ย ย ย ย ย ย ย ย ย <span id="qty-${product.id}" class="font-bold text-lg w-6 text-center">${currentQty}</span>
ย ย ย ย ย ย ย ย ย ย <button class="text-green-500 p-1 rounded-full hover:bg-green-100 transition" 
ย ย ย ย ย ย ย ย ย ย ย ย ย ย data-product-id="${product.id}" 
ย ย ย ย ย ย ย ย ย ย ย ย ย ย data-product-name="${product.name}" 
ย ย ย ย ย ย ย ย ย ย ย ย ย ย data-product-price="${product.price}" 
ย ย ย ย ย ย ย ย ย ย ย ย ย ย data-action="add">
ย ย ย ย ย ย ย ย ย ย ย ย <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z" clip-rule="evenodd" /></svg>
ย ย ย ย ย ย ย ย ย ย </button>
ย ย ย ย ย ย ย ย </div>
ย ย ย ย ย ย `;
ย ย ย ย ย ย productsContainer.appendChild(card);
ย ย ย ย ย ย 
ย ย ย ย ย ย // ิฑีพีฅีฌีกึีถีธึีด ีฅีถึ event listener-ีถีฅึ ีฏีธีณีกีฏีถีฅึีซีถ
ย ย ย ย ย ย card.querySelectorAll('button').forEach(button => {
ย ย ย ย ย ย ย ย button.addEventListener('click', (e) => {
ย ย ย ย ย ย ย ย ย ย const { productId, productName, productPrice, action } = e.currentTarget.dataset;
ย ย ย ย ย ย ย ย ย ย const priceNum = parseFloat(productPrice);

ย ย ย ย ย ย ย ย ย ย if (action === 'add') {
ย ย ย ย ย ย ย ย ย ย ย ย updateCart(productId, productName, priceNum, 1);
ย ย ย ย ย ย ย ย ย ย } else if (action === 'remove') {
ย ย ย ย ย ย ย ย ย ย ย ย updateCart(productId, productName, priceNum, -1);
ย ย ย ย ย ย ย ย ย ย }
ย ย ย ย ย ย ย ย });
ย ย ย ย ย ย });
ย ย ย ย }
ย ย ย ย 
ย ย ย ย // ----------------------------------------------------
ย ย ย ย // 4. ีีี ีีีิฑิผีิตีิป ิฑีิติผิฑีีีี (SEED DATA)
ย ย ย ย // ----------------------------------------------------
ย ย ย ย 
ย ย ย ย async function seedData() {
ย ย ย ย ย ย const mockProducts = [
ย ย ย ย ย ย ย ย { name: "ิฑีดีกีผีกีตีซีถ ิถีฃีฅีฝีฟ", price: 9500, description: "ินีฅีฉึ, ีขีกีดีขีกีฏีตีก ีฆีฃีฅีฝีฟึ", imageUrl: "https://placehold.co/400x300/a3e635/166534?text=Dress" },
ย ย ย ย ย ย ย ย { name: "ีีบีธึีฟีกีตีซีถ ิฟีธีทีซีฏีถีฅึ", price: 18000, description: "ีีกึีดีกึีกีพีฅีฟ ีพีกีฆึีซ ีฐีกีดีกึึ", imageUrl: "https://placehold.co/400x300/4ade80/065f46?text=Shoes" },
ย ย ย ย ย ย ย ย { name: "ิฑีถีปึีกีถึีซีฏ ิบีกีดีกึีธึีตึ", price: 12500, description: "ิตึีฏีกึีกีฏีตีกึ, ีฝีบีธึีฟีกีตีซีถ ีดีธีคีฅีฌึ", imageUrl: "https://placehold.co/400x300/34d399/047857?text=Watch" },
ย ย ย ย ย ย ย ย { name: "ิฒีกีณีฏีธีถ", price: 29990, description: "ีีกึ, ีฑีดีฅีผีกีตีซีถ ีขีกีณีฏีธีถึ", imageUrl: "https://placehold.co/400x300/6ee7b7/059669?text=Jacket" }
ย ย ย ย ย ย ];
ย ย ย ย ย ย 
ย ย ย ย ย ย const path = `artifacts/${app_id}/public/data/products`;
ย ย ย ย ย ย const batch = db.batch();
ย ย ย ย ย ย 
ย ย ย ย ย ย try {
ย ย ย ย ย ย ย ย // ีีกีญี ีปีถีปีธึีด ีฅีถึ ีฐีซีถ ีกีบึีกีถึีถีฅึีจ
ย ย ย ย ย ย ย ย const snapshot = await db.collection(path).get();
ย ย ย ย ย ย ย ย snapshot.docs.forEach(doc => batch.delete(doc.ref));

ย ย ย ย ย ย ย ย // ิฑีพีฅีฌีกึีถีธึีด ีฅีถึ ีถีธึีฅึีจ
ย ย ย ย ย ย ย ย mockProducts.forEach((product, index) => {
ย ย ย ย ย ย ย ย ย ย const docRef = db.collection(path).doc(`prod_${index + 1}`);
ย ย ย ย ย ย ย ย ย ย batch.set(docRef, product);
ย ย ย ย ย ย ย ย });
ย ย ย ย ย ย ย ย 
ย ย ย ย ย ย ย ย await batch.commit();
ย ย ย ย ย ย ย ย showMessage("ีึีซีถีกีฏีฅีฌีซ ีกีบึีกีถึีถีฅึีถ ีกีพีฅีฌีกึีพีฅึีซีถึ ิฝีถีคึีธึีด ีฅีถึ ีฉีกึีดีกึีถีฅีฌ ีงีปีจึ");
ย ย ย ย ย ย ย ย fetchProducts(); // ินีกึีดีกึีถีธึีด ีฅีถึ ีกีบึีกีถึีถีฅึีซ ึีธึึีกีฏีจ
ย ย ย ย ย ย ย ย 
ย ย ย ย ย ย } catch (error) {
ย ย ย ย ย ย ย ย console.error("Error seeding data:", error);
ย ย ย ย ย ย ย ย showMessage(`ีีญีกีฌี ีฟีพีตีกีฌีถีฅึีถ ีกีพีฅีฌีกึีถีฅีฌีซีฝ: ${error.message}`);
ย ย ย ย ย ย }
ย ย ย ย }


ย ย ย ย // ----------------------------------------------------
ย ย ย ย // 5. ีีิฑีีิฑี ิณีีิพิธีินิฑีิป ีิติฟีิฑีิฟ
ย ย ย ย // ----------------------------------------------------
ย ย ย ย 
ย ย ย ย function startCheckout() {
ย ย ย ย ย ย // ีีกีฟึีกีฝีฟีธึีด ีฅีถึ ีฆีกีดีขีตีธึีฒีซ ีฟีพีตีกีฌีถีฅึีจ, ีธึีธีถึ ีฏีธึีฒีกึีฏีพีฅีถ ีขีธีฟีซีถ
ย ย ย ย ย ย const cartArray = Object.keys(cart).map(id => ({
ย ย ย ย ย ย ย ย id: id,
ย ย ย ย ย ย ย ย name: cart[id].name,
ย ย ย ย ย ย ย ย price: cart[id].price,
ย ย ย ย ย ย ย ย quantity: cart[id].quantity
ย ย ย ย ย ย }));

ย ย ย ย ย ย // ีีธีญีกึีฏีธึีด ีฅีถึ JSON ีฟีธีฒีซ
ย ย ย ย ย ย const cartJson = JSON.stringify(cartArray);
ย ย ย ย ย ย 
ย ย ย ย ย ย // ีึีฒีกึีฏีธึีด ีฅีถึ ีฟีพีตีกีฌีถีฅึีจ Telegram ิฒีธีฟีซีถี ีพีณีกึีธึีดีจ ีฝีฏีฝีฅีฌีธึ ีฐีกีดีกึ:
ย ย ย ย ย ย // ิฒีธีฟีซ backend-ีจ (main.py) ีฏีฝีฟีกีถีก ีกีตีฝ ีฟีพีตีกีฌีถีฅึีจ ีธึีบีฅีฝ web_app_data
ย ย ย ย ย ย tg.sendData(cartJson);
ย ย ย ย ย ย 
ย ย ย ย ย ย // ิบีกีดีกีถีกีฏีกีพีธึีกีบีฅีฝ ึีธึึีกีคึีธึีด ีฅีถึ ีฐีกีฒีธึีคีกีฃึีธึีฉีตีธึีถ
ย ย ย ย ย ย showMessage("ีีกีฟีพีฅึีซ ีฟีพีตีกีฌีถีฅึีจ ีธึีฒีกึีฏีพีฅีฌ ีฅีถ ิฒีธีฟีซีถึ ิฝีถีคึีธึีด ีฅีถึ ีฐีฅีฟึีฅีฌ ิฒีธีฟีซ ีนีกีฉีซีถึ");
ย ย ย ย }

ย ย ย ย 
ย ย ย ย // ----------------------------------------------------
ย ย ย ย // 6. ิฑีีิฑีีิป ีิฑีีิป ีีีิฑีิฟีีี (ีีี ีีีีิฟีิปิฑ)
ย ย ย ย // ----------------------------------------------------

ย ย ย ย async function sendProductRequest() {
ย ย ย ย ย ย const requestName = document.getElementById('request-name').value.trim();
ย ย ย ย ย ย const requestLink = document.getElementById('request-link').value.trim();

ย ย ย ย ย ย if (requestName === '') {
ย ย ย ย ย ย ย ย showMessage("ิฝีถีคึีธึีด ีฅีถึ ีดีธึีฟึีกีฃึีฅีฌ ีกีบึีกีถึีซ ีกีถีธึีถีจ ีฏีกีด ีถีฏีกึีกีฃึีธึีฉีตีธึีถีจึ");
ย ย ย ย ย ย ย ย return;
ย ย ย ย ย ย }

ย ย ย ย ย ย const requestData = {
ย ย ย ย ย ย ย ย name: requestName,
ย ย ย ย ย ย ย ย link: requestLink,
ย ย ย ย ย ย ย ย userId: userId, // Firebase Auth ID
ย ย ย ย ย ย ย ย tgUserId: tg.initDataUnsafe.user ? tg.initDataUnsafe.user.id : 'N/A',
ย ย ย ย ย ย ย ย timestamp: firebase.firestore.FieldValue.serverTimestamp()
ย ย ย ย ย ย };
ย ย ย ย ย ย 
ย ย ย ย ย ย const path = `artifacts/${app_id}/requests`; // ีีธึ ีฏีธีฌีฅีฏึีซีก ีฐีกีตีฟีฅึีซ ีฐีกีดีกึ

ย ย ย ย ย ย try {
ย ย ย ย ย ย ย ย // 1. ีีพีตีกีฌีถีฅึีจ ีบีกีฐีธึีด ีฅีถึ Firebase-ีธึีด
ย ย ย ย ย ย ย ย await db.collection(path).add(requestData);
ย ย ย ย ย ย ย ย 
ย ย ย ย ย ย ย ย // 2. ิพีกีถีธึึีธึีด ีฅีถึ ีธึีฒีกึีฏีธึีด ิฒีธีฟีซีถ (ีกีคีดีซีถีซีฝีฟึีกีฟีธึีซีถ ีฆีฃีธึีทีกึีถีฅีฌีธึ ีฐีกีดีกึ)
ย ย ย ย ย ย ย ย const linkDisplay = requestLink ? `(ีีฒีธึีด: ${requestLink})` : '';
ย ย ย ย ย ย ย ย const notificationText = `PRODUCT_REQUEST: ${requestName} ${linkDisplay} | User ID: ${requestData.tgUserId}`;
ย ย ย ย ย ย ย ย 
ย ย ย ย ย ย ย ย // ีึีฒีกึีฏีธึีด ีฅีถึ ิฒีธีฟีซีถี ีฐีฅีฟีกีฃีก ีดีทีกีฏีดีกีถ ีฐีกีดีกึ
ย ย ย ย ย ย ย ย tg.sendData(notificationText);

ย ย ย ย ย ย ย ย showMessage("ีีถีธึีฐีกีฏีกีฌีธึีฉีตีธึีถึ ีีฅึ ีฐีกีตีฟีถ ีธึีฒีกึีฏีพีฅีฌ ีง ีดีฅีฆึ ีีฅีถึ ีทีธึีฟีธีพ ีกีตีถ ีฏีกีพีฅีฌีกึีถีฅีถึ ีญีกีถีธึีฉึ");
ย ย ย ย ย ย ย ย 
ย ย ย ย ย ย ย ย // ีีกึึีธึีด ีฅีถึ ีคีกีทีฟีฅึีจ
ย ย ย ย ย ย ย ย document.getElementById('request-name').value = '';
ย ย ย ย ย ย ย ย document.getElementById('request-link').value = '';

ย ย ย ย ย ย } catch (error) {
ย ย ย ย ย ย ย ย console.error("Error sending request:", error);
ย ย ย ย ย ย ย ย showMessage(`ีีญีกีฌี ีฐีกีตีฟีถ ีธึีฒีกึีฏีฅีฌีซีฝึ ิฝีถีคึีธึีด ีฅีถึ ึีธึีฑีฅีฌ ีถีธึีซึึ`);
ย ย ย ย ย ย }
ย ย ย ย }


ย ย ย ย // ิฟึีธึีด ีฅีถึ event listener-ีถีฅึีจ
ย ย ย ย checkoutButton.addEventListener('click', startCheckout);
ย ย ย ย tg.MainButton.onClick(startCheckout);
ย ย ย ย 
ย ย ย ย // ิฟึีธึีด ีฅีถึ ีีี ีฏีธีณีกีฏีซ ีฌีฝีธีฒีจ
ย ย ย ย document.getElementById('send-request-button').addEventListener('click', sendProductRequest);


ย ย ย ย // ิณีธึีฎีกึีฏีธึีด ีฅีถึ ีซีถีซึีซีกีฌีซีฆีกึีซีกีถ, ีฅึีข ีงีปีจ ีขีฅีผีถีพีกีฎ ีง
ย ย ย ย window.onload = initializeFirebase;
ย ย </script>
</body>
</html>
